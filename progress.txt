2026-01-12: Added initial Convex schema for core entitlements tables (guilds, tiers, member identities, entitlement grants, audit events).
2026-01-12: Added Convex mutation for manual entitlement grants with audit events.
2026-01-12: Added Convex mutation to revoke entitlement grants with audit events.
2026-01-12: Added member snapshot query returning entitlements plus audit events, indexed by subject user for admin lookup.
2026-01-12: Added tier management mutations (create/update) and list query with entitlement policy validation plus audit events.
2026-01-12: Added Convex guild upsert + lookup functions with audit events for onboarding workflows.
2026-01-12: Added member identity upsert mutation for Discord OAuth linkage with audit events (no token logging).
2026-01-12: Added role sync request table and admin mutation for force sync requests (guild/user) with audit events.
2026-01-12: Added role sync request claim/completion mutations for bot workers with audit events.
2026-01-12: Added Convex query to compute desired role IDs for a member from active entitlements for bot role sync.
2026-01-12: Added guild diagnostics schema plus upsert/get mutations for onboarding checks with audit events.
2026-01-12: Added provider event log table plus idempotent record/mark processed mutations for webhook dedupe.
2026-01-12: Added guild audit events feed query with optional member filter for admin timelines.
2026-01-12: Added Stripe webhook HTTP endpoint with signature verification and normalized provider event logging.
2026-01-12: Captured Stripe price IDs on webhook ingestion and stored them on provider events for downstream entitlement mapping.
2026-01-12: Added Authorize.Net webhook HTTP endpoint with signature verification and normalized provider event logging.
2026-01-12: Added query to report active member counts by tier for admin reporting.
2026-01-12: Added scheduled job to expire entitlement grants past validThrough with audit events.
2026-01-12: Added admin member search query to find linked Discord users by id or username.
2026-01-12: Added provider customer link table and upsert/lookup mutations to map payment provider customer IDs to Discord users per guild.
2026-01-12: Captured Authorize.Net merchantReferenceId on webhook ingestion for tier mapping.
2026-01-12: Added Convex query to list recent role sync requests by guild or user for admin diagnostics.
2026-01-12: Added provider event diagnostics query to surface the latest webhook per provider for a guild (matched by customer or price ids).
2026-01-12: Added minimal REST API HTTP endpoints for tier listing, member search, member snapshots, and audit timelines guarded by PERKCORD_REST_API_KEY.
2026-01-12: Added scheduled job to retry failed role sync requests with safeguards against duplicate retries.
2026-01-12: Added admin portal skeleton Next.js app with Discord OAuth login and signed session cookie.
2026-01-12: Added outbound webhook endpoint schema plus create/update/list mutations with signing secrets and audit events.
2026-01-12: Added REST API admin endpoints to create and revoke manual entitlement grants.
2026-01-12: Added outbound webhook delivery queue with retry/backoff processing and enqueue hooks for grant/role sync events.
2026-01-12: Added provider event processing job to convert normalized Stripe/Authorize.Net events into entitlement grants with audit trails and membership webhooks.
2026-01-12: Added REST API endpoint to request admin force-sync (guild or user) role sync jobs.
2026-01-12: Added member flow stub pages in the Next.js app (tier selection, Discord connect placeholder, payment placeholder, celebration page with Discord deep link hint).
2026-01-12: Added Discord bot worker skeleton that upserts guilds, runs onboarding diagnostics, and processes role sync requests by applying role deltas from Convex entitlements.
2026-01-12: Added Discord bot role sync retry/backoff handling for rate limits and transient Discord API errors.
2026-01-12: Added member Discord OAuth connect flow with role_connections.write scope, encrypted token storage, and Convex member identity linkage.
2026-01-12: Added admin portal force sync form and API route to request role sync jobs via the Convex REST API.
2026-01-12: Added admin portal member lookup panels for member search, snapshots, and audit timelines using the Convex REST API.
2026-01-12: Added admin health overview panel plus REST endpoints for active member counts and latest provider events.
2026-01-12: Added REST API endpoint and admin health card for guild onboarding diagnostics (permissions, role hierarchy, missing roles).
2026-01-12: Added admin portal manual grant/revoke forms with Convex REST API proxy routes and tier hints.
2026-01-12: Added Stripe checkout session creation API plus member pay page wiring with tier-based Stripe price configuration.
2026-01-12: Added admin portal recent audit events feed for guild lifecycle visibility.
2026-01-12: Added admin tier management REST endpoints plus admin portal forms for creating and updating tier mappings.
2026-01-12: Added member session cookie after Discord OAuth and linked Stripe customer IDs to Discord users during checkout for provider-customer mapping.
2026-01-12: Added REST API endpoint and admin health panel to surface failed outbound webhook deliveries for dead-letter visibility.
2026-01-12: Added REST API endpoint and admin portal card to display role sync request history for member snapshots.
2026-01-12: Added Authorize.Net one-time checkout flow with Accept.js tokenization, server transaction route, and webhook invoiceNumber fallback for tier mapping.
